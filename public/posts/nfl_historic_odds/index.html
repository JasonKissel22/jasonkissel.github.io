<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>NFL_historic_odds | Jason Kissel | Data Analytics</title>
<meta name="keywords" content="">
<meta name="description" content="This project explores historic NFL odds and outcomes.
I used a combination of web scraping, data cleaning, and analysis to identify trends and patterns across seasons.
The goal is to document the full process from data acquisition to visualization, highlighting the decision-making at each step.
To start, I needed to create a spreadsheet for historical odds. This didn&rsquo;t need to be automated because it is historical data. However, I would like to figure out how to automate the process during the NFL season. For now, I do not need to do that.">
<meta name="author" content="Jason Kissel">
<link rel="canonical" href="http://localhost:1313/posts/nfl_historic_odds/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a29c24210eb31d9ce56f669c66a35c9c51b17376b7764e336a49af7dec914cf0.css" integrity="sha256-opwkIQ6zHZzlb2acZqNcnFGxc3a3dk4zakmvfeyRTPA=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/nfl_historic_odds/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Jason Kissel | Data Analytics (Alt + H)">Jason Kissel | Data Analytics</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      NFL_historic_odds
    </h1>
    <div class="post-meta"><span title='2026-02-23 00:00:00 +0000 UTC'>February 23, 2026</span>&nbsp;¬∑&nbsp;<span>6 min</span>&nbsp;¬∑&nbsp;<span>Jason Kissel</span>

</div>
  </header> 
  <div class="post-content"><p>This project explores historic NFL odds and outcomes.</p>
<p>I used a combination of web scraping, data cleaning, and analysis to identify trends and patterns across seasons.</p>
<p>The goal is to document the full process from data acquisition to visualization, highlighting the decision-making at each step.</p>
<p>To start, I needed to create a spreadsheet for historical odds. This didn&rsquo;t need to be automated because it is historical data. However, I would like to figure out how to automate the process during the NFL season. For now, I do not need to do that.</p>
<p>It took a few iterations in order to get data that I really wanted to work with. For this project, I knew I wanted the end result to be a Looker Studio Dashboard. I have had some familiarity with this data viz tool and wanted to try and use this project to start pushing myself towards more data analytics goals. In lieu of sharing every iteration of my data exploration, I&rsquo;ll share some brief highlights below
-Utilized ChatGPT + Claude to find historical data for all NFL games first (Season, Date, Home/Away, Teams, Score) and imported that into a Google Sheet.
-Searched multiple sites looking for historical betting data (Spread, Over/Under) and utilized AI to write a Google Apps Script that combined the data.
-Once we had the information in a spreadsheet, it became obvious that the filters within Google Data Studio would not be possible in the way that I wanted with the data that I had. So, I ended up having Claude write a script that split every game into two rows. I&rsquo;ll explain this transformation in more detail with respect to the dashboard.</p>
<p>You can view my spreadsheet below.</p>

<div style="width: 100%; max-width: 900px; margin: 0 auto;">
  <iframe width="100%" height="850" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRKzpzMePwq38w_FOCr0gUN801jLABCxa5Or2hTbmNRecLTffWP9XtvZwabpuY0c6V5aCtFpAidmjj3/pubhtml?widget=true&headers=false" frameborder="0"></iframe>
</div>

<p>I may explain more about the spreadsheet here. I may not. For now, I&rsquo;m going to keep going.</p>
<h2 id="looker-studio-dashboard">Looker Studio Dashboard<a hidden class="anchor" aria-hidden="true" href="#looker-studio-dashboard">#</a></h2>
<p>I&rsquo;d like to point out a couple of considerations for the dashboard before you jump in. I&rsquo;ll also give you some questions that drove the layout of the dashboard.</p>
<ul>
<li>The scorecards across the middle of the screen will look messy until Seasons or Weeks have been filtered.</li>
<li>The dashboard works best with more restrictions, so don&rsquo;t be afraid to be specific with your constraints. They should all work as a union of events.</li>
<li>As you can see, weeks 21, 22, 23, and 24 are their respective playoff round as seen on the sheet. I&rsquo;m still basic so this was my best version of keeping everything working as I had hoped.</li>
<li>Lastly, the team name is accurate to the time period that they were active. So, it&rsquo;s possible, if looking at a franchise&rsquo;s history, that you&rsquo;d need to select multiple teams. We utilized a shorthand within the data on the spreadsheet which you&rsquo;d see as nfl_teams.</li>
</ul>
<p>The questions I sought to answer were things like the following:</p>
<ul>
<li>How did home underdogs do in the last month of the season the last five years?</li>
<li>How often does the over/under hit for a spread above 56?</li>
<li>How do the Atlanta Falcons do as a road favorite in history? In the last 20 years? In the last 5 years?</li>
<li>Is there a difference between over/under totals in early weeks as opposed to later weeks in the season?</li>
<li>What teams consistently perform the best against the spread over the last 2-3 seasons?</li>
</ul>
<p>It became the most useful looking at a specific scenario. I&rsquo;ll give an example: In Week 4 of the 2025 NFL season, the Pittsburgh Steelers were a home underdog. They have not had a consistent QB since Big Ben retired, they have had the same coach, so other variables that could sway my data weren&rsquo;t really a factor. In home underdog games since 2021, the Steelers were 9-4-1 against the spread. That&rsquo;s a good singular data point to think they&rsquo;d at least cover the game. You could also investigate them winning outright in these games, their home record in this time, or even their record against the spread in this time. But, we should see that record closer to .500 than anything. So, it seems substantial enough to think about.</p>

<iframe width="1300px" height="400" src="https://lookerstudio.google.com/embed/reporting/6292eaeb-9869-46e9-bc6c-94cdb6359560/page/1M" frameborder="0" style="border:0" allowfullscreen></iframe>

<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>What started as a silly idea between a few friends about trying to gain an edge on $0.25 bets became a wonderful example of how data can be found, transformed, and analyzed in a relatively simple setting. There were many discoveries along the way, which I plan, in future projects, to document more precisely than I have here. Additionally, I have not given proper credit to sites like pro-football-reference.com, which were instrumental to finding accurate data. While a proper analysis would give findings based on the questions asked, this project serves as a playground for all NFL fans out there. I&rsquo;d love to see the interesting conclusions you find by sorting by what you think is interesting, just as I did myself. Start with your favorite team and expand your knowledge from there.</p>
<p>I will add a snippet of apps script below as an example. However, the prompting between myself and Claude would be more valuable in reality, since I can read and interpret the script, but I find writing 400 lines purely on brain power to be incomprehensible with the tools that we have at our disposal. I hope you enjoy playing with the data as much as I have.</p>
<h2 id="apps-script-example">Apps Script Example<a hidden class="anchor" aria-hidden="true" href="#apps-script-example">#</a></h2>
<p>For all of those pining to know some of the script I had Claude write for me, I&rsquo;ll attach a snippet below. I iterated a few times and I ended up using a few different scripts. This is just the first portion of my script that transformed the raw data into the data that had two rows per game.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transformNFLData</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getActiveSpreadsheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#39;Raw Data&#39;</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getActiveSheet</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sourceData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sourceSheet</span>.<span style="color:#a6e22e">getDataRange</span>().<span style="color:#a6e22e">getValues</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sourceData</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;No data found or insufficient data in the sheet&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">games</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">errors</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">sourceData</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">row</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sourceData</span>[<span style="color:#a6e22e">i</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">row</span>.<span style="color:#a6e22e">every</span>(<span style="color:#a6e22e">cell</span> =&gt; <span style="color:#a6e22e">cell</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">cell</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">cell</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;undefined&#39;</span>)) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// parse spread &amp; over/under safely
</span></span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">spreadRaw</span> <span style="color:#f92672">=</span> parseFloat(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">9</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (isNaN(<span style="color:#a6e22e">spreadRaw</span>)) <span style="color:#a6e22e">spreadRaw</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">ouRaw</span> <span style="color:#f92672">=</span> parseFloat(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">10</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (isNaN(<span style="color:#a6e22e">ouRaw</span>)) <span style="color:#a6e22e">ouRaw</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">game</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">date</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">date</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">season</span><span style="color:#f92672">:</span> parseInt(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">1</span>]) <span style="color:#f92672">||</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">week</span><span style="color:#f92672">:</span> parseInt(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">||</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">playoff</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">===</span> <span style="color:#66d9ef">true</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;TRUE&#39;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;true&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">homeTeam</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;&#39;</span>).<span style="color:#a6e22e">toString</span>().<span style="color:#a6e22e">trim</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">homeScore</span><span style="color:#f92672">:</span> (isFinite(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">5</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#f92672">?</span> Number(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">5</span>]) <span style="color:#f92672">:</span> parseInt(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">5</span>]) <span style="color:#f92672">||</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">awayScore</span><span style="color:#f92672">:</span> (isFinite(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">6</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#f92672">?</span> Number(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">6</span>]) <span style="color:#f92672">:</span> parseInt(<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">6</span>]) <span style="color:#f92672">||</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">awayTeam</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;&#39;</span>).<span style="color:#a6e22e">toString</span>().<span style="color:#a6e22e">trim</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">favoriteTeam</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">row</span>[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;&#39;</span>).<span style="color:#a6e22e">toString</span>().<span style="color:#a6e22e">trim</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">spread</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">spreadRaw</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">overUnder</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ouRaw</span>
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">game</span>.<span style="color:#a6e22e">homeTeam</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">game</span>.<span style="color:#a6e22e">awayTeam</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">`Row </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">: Missing team names`</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">games</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">game</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">`Row </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">games</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;No valid games found in the data&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">teamRows</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">transformToTeamRows</span>(<span style="color:#a6e22e">games</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// output sheet creation/clear
</span></span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">outputSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">getSheetByName</span>(<span style="color:#e6db74">&#39;Transformed Data&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">outputSheet</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">outputSheet</span>.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">outputSheet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ss</span>.<span style="color:#a6e22e">insertSheet</span>(<span style="color:#e6db74">&#39;Transformed Data&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">headers</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;Date&#39;</span>, <span style="color:#e6db74">&#39;Season&#39;</span>, <span style="color:#e6db74">&#39;Week&#39;</span>, <span style="color:#e6db74">&#39;Playoff&#39;</span>, <span style="color:#e6db74">&#39;Team&#39;</span>, <span style="color:#e6db74">&#39;Opponent&#39;</span>, <span style="color:#e6db74">&#39;Home_Away&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;Team_Score&#39;</span>, <span style="color:#e6db74">&#39;Opponent_Score&#39;</span>, <span style="color:#e6db74">&#39;Win&#39;</span>, <span style="color:#e6db74">&#39;Point_Margin&#39;</span>, <span style="color:#e6db74">&#39;Favorite&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;Spread&#39;</span>, <span style="color:#e6db74">&#39;Covered_Spread&#39;</span>, <span style="color:#e6db74">&#39;Over_Under_Line&#39;</span>, <span style="color:#e6db74">&#39;Total_Points&#39;</span>, <span style="color:#e6db74">&#39;Over_Under_Result&#39;</span>
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">outputData</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">headers</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">teamRows</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">r</span> =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">outputData</span>.<span style="color:#a6e22e">push</span>([
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">r</span>.Date, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Season</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Week</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Playoff</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Team</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Opponent</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Home_Away</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Team_Score</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Opponent_Score</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Win</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Point_Margin</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Favorite</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Spread</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">ATS_Result</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Over_Under_Line</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Total_Points</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Over_Under_Result</span>
</span></span><span style="display:flex;"><span>    ]);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">outputSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">outputData</span>.<span style="color:#a6e22e">length</span>, <span style="color:#a6e22e">headers</span>.<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setValues</span>(<span style="color:#a6e22e">outputData</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">outputSheet</span>.<span style="color:#a6e22e">getRange</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">headers</span>.<span style="color:#a6e22e">length</span>).<span style="color:#a6e22e">setFontWeight</span>(<span style="color:#e6db74">&#39;bold&#39;</span>).<span style="color:#a6e22e">setBackground</span>(<span style="color:#e6db74">&#39;#4285f4&#39;</span>).<span style="color:#a6e22e">setFontColor</span>(<span style="color:#e6db74">&#39;white&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">outputSheet</span>.<span style="color:#a6e22e">autoResizeColumns</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">headers</span>.<span style="color:#a6e22e">length</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">summary</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Transformation Complete!
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">üìä Summary:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">‚Ä¢ </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">games</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> games processed
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">‚Ä¢ </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">teamRows</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> team records created
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">‚Ä¢ </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> errors encountered
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span><span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;‚ö†Ô∏è Errors:\n&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;\n&#39;</span>) <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  `</span>.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SpreadsheetApp</span>.<span style="color:#a6e22e">getUi</span>().<span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">summary</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">outputSheet</span>.<span style="color:#a6e22e">activate</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Jason Kissel | Data Analytics</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
